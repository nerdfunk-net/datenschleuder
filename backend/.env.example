# Datenschleuder Backend Configuration
# Copy this file to .env and modify the values as needed
#
# Configuration Sections:
#   - Server Configuration: Basic server settings
#   - Nautobot Configuration: Connection to Nautobot instance
#   - Authentication: JWT and initial credentials
#   - OIDC/SSO Authentication: See config/oidc_providers.yaml for configuration
#   - Git SSL Configuration: Custom certificates for Git
#   - File Storage: Upload and file handling settings
#   - Logging: Log level and format
#
# OIDC/SSO Configuration:
#   OIDC is now configured via YAML file (config/oidc_providers.yaml)
#   See config/oidc_providers.yaml.example for examples
#   See OIDC_SETUP.md for detailed setup instructions

# ============================================================================
# Server Configuration
# ============================================================================
# Use backend-specific variables to avoid ambiguity when running frontend/backend together
BACKEND_SERVER_HOST=127.0.0.1
BACKEND_SERVER_PORT=8000

# Legacy names (kept for reference and backward compatibility):
# SERVER_HOST=127.0.0.1
# SERVER_PORT=8000

# ============================================================================
# Authentication Configuration
# ============================================================================
SECRET_KEY=your-secret-key-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Initial credentials for first-time setup (used when creating the initial credential on first startup)
INITIAL_USERNAME=admin
INITIAL_PASSWORD=admin

# ============================================================================
# OIDC / SSO Authentication Configuration
# ============================================================================
# OIDC authentication is now configured via YAML file for better multi-provider support.
#
# Configuration Location: config/oidc_providers.yaml
# Example Configuration: config/oidc_providers.yaml.example
# Documentation: OIDC_SETUP.md
#
# Quick Setup:
#   1. Copy config/oidc_providers.yaml.example to config/oidc_providers.yaml
#   2. Enable at least one provider and configure its settings
#   3. Restart the backend server
#   4. SSO login buttons will appear on the login page
#
# Legacy Environment Variable Support:
# The following environment variables are still supported for backward compatibility
# but the YAML configuration method is recommended for all new deployments.
#
# If you need to use environment variables (not recommended):
# OIDC_ENABLED=false
# OIDC_DISCOVERY_URL=
# OIDC_CLIENT_ID=
# OIDC_CLIENT_SECRET=
# OIDC_REDIRECT_URI=http://localhost:3000/login/callback
# OIDC_SCOPES=openid,profile,email,offline_access
# OIDC_CLAIM_USERNAME=preferred_username
# OIDC_CLAIM_EMAIL=email
# OIDC_CLAIM_NAME=name
# OIDC_AUTO_PROVISION=true

# ============================================================================
# Git SSL Configuration
# ============================================================================
# For self-hosted Git servers with custom certificates
GIT_SSL_VERIFY=true
# GIT_SSL_CA_INFO=/path/to/custom-ca-cert.pem
# GIT_SSL_CERT=/path/to/client-cert.pem

# ============================================================================
# File Storage Configuration
# ============================================================================
# Directory where configuration files are stored (relative to backend directory)
CONFIG_FILES_DIRECTORY=config_files

# Allowed file extensions for configuration files (comma-separated)
ALLOWED_FILE_EXTENSIONS=.txt,.conf,.cfg,.config,.ini,.yaml,.yml,.json

# Maximum file size in MB for file uploads and comparisons
MAX_FILE_SIZE_MB=10

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# ============================================================================
# Redis and Celery Configuration
# ============================================================================
# Redis server configuration for Celery message broker and result backend
DATENSCHLEUDER_REDIS_HOST=localhost
DATENSCHLEUDER_REDIS_PORT=6379
DATENSCHLEUDER_REDIS_PASSWORD=changeme

# Celery worker configuration
CELERY_MAX_WORKERS=4

# Advanced: Override Redis URL (auto-generated from REDIS_HOST, REDIS_PORT, REDIS_PASSWORD)
# REDIS_URL=redis://:password@localhost:6379/0

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
# PostgreSQL database connection settings
# Note: SQLite support has been removed. PostgreSQL is now required.
DATENSCHLEUDER_DATABASE_HOST=localhost
DATENSCHLEUDER_DATABASE_PORT=5432
DATENSCHLEUDER_DATABASE_NAME=app-template
DATENSCHLEUDER_DATABASE_USERNAME=postgres
DATENSCHLEUDER_DATABASE_PASSWORD=postgres
DATENSCHLEUDER_DATABASE_SSL=false
